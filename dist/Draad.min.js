"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function n(t,e){for(var s=0;s<e.length;s++){var n=e[s];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,s){return e&&n(t.prototype,e),s&&n(t,s),t}}();function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var Draad=function(){function n(t){var e=this,s=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};_classCallCheck(this,n);this.defaults=Object.assign({},{element:"",parentClass:"",offsetX:"",offsetY:"",fill:"",color:"#000",lineWidth:"1",lineOpacity:"",dasharray:"",cap:"",responsive:"",options:"",wait:0,smoothing:.2,absoluteUnits:!1},s),this.element=t,this.parent=function(){return e.defaults.parentClass.length<1?document.getElementsByTagName("body")[0]:e.findAncestor(document.getElementsByClassName(t)[0],e.defaults.parentClass)},this.smoothing=this.defaults.smoothing,this.offsetX=this.defaults.offsetX,this.offsetY=this.defaults.offsetY,this.fill=this.defaults.fill,this.color=this.defaults.color,this.lineWidth=this.defaults.lineWidth,this.lineOpacity=this.defaults.lineOpacity,this.dasharray=this.defaults.dasharray,this.cap=this.defaults.cap,this.responsive=this.defaults.responsive,this.absoluteUnits=this.defaults.absoluteUnits,this.options=this.defaults,setTimeout(function(){e.init()},this.defaults.wait)}return _createClass(n,[{key:"findAncestor",value:function(t,e){return t.closest("."+e)}},{key:"goThroughDots",value:function(){var t=document.getElementsByClassName(this.element),e=[],s=this.offsetX,n=this.offsetY,i=document.body,a=document.documentElement,o=window.pageYOffset||a.scrollTop||i.scrollTop,l=a.clientTop||i.clientTop||0;if(this.parent()===document.getElementsByTagName("body")[0])for(var r=0;r<t.length;r++){var h=document.getElementsByClassName(this.element)[r],u=h.getBoundingClientRect().top+o-l,c=s||h.offsetWidth/2,f=n||h.offsetHeight/2,d=parseInt(h.getBoundingClientRect().left+c,10),g=parseInt(Math.round(u)+f,10);e.push([d,g])}else for(var p=0;p<t.length;p++){var m=document.getElementsByClassName(this.element)[p],y=s||m.offsetWidth/2,v=n||m.offsetHeight/2,C=m.getBoundingClientRect().top+o-l,b=parseInt(m.offsetLeft+y,10),w=parseInt(m.offsetTop+v,10);!0===this.absoluteUnits&&(b=parseInt(m.getBoundingClientRect().left+y,10),w=parseInt(Math.round(C)+v,10)),e.push([b,w])}return e}},{key:"connectingMagic",value:function(t){var c=this.smoothing,e=this.parent(),a=function(t,e,s,n){var i,a,o,l,r=(i=e||t,o=(a=s||t)[0]-i[0],l=a[1]-i[1],{length:Math.sqrt(Math.pow(o,2)+Math.pow(l,2)),angle:Math.atan2(l,o)}),h=r.angle+(n?Math.PI:0),u=r.length*c;return[t[0]+Math.cos(h)*u,t[1]+Math.sin(h)*u]},s=t.length,n=t[0][1],i=t[s-1][1],o="http://www.w3.org/2000/svg",l=document.createElementNS(o,"svg");l.setAttribute("class","draad-line draad-line--"+this.element);var r,h=document.createElementNS(o,"path");h.setAttribute("d",(r=function(t,e,s){var n=a(s[e-1],s[e-2],t),i=a(t,s[e-1],s[e+1],!0);return"C "+n[0]+","+n[1]+" "+i[0]+","+i[1]+" "+t[0]+","+t[1]},t.reduce(function(t,e,s,n){return 0===s?"M "+e[0]+","+e[1]:t+" "+r(e,s,n)},""))),h.setAttribute("fill","none"),h.setAttribute("stroke","black"),l.appendChild(h);var u=this.fill,f=this.color,d=this.lineWidth,g=this.lineOpacity,p=this.dasharray,m=this.cap;h.setAttribute("style","fill: "+u+"; stroke: "+f+"; stroke-width: "+d+";stroke-opacity: "+g+";stroke-dasharray: "+p+";stroke-linecap: "+m),l.setAttribute("style","width: 100%; min-height: 100%; height: "+(i-n)+"px;top: 0; left: 0; bottom: 0; right: 0; position: absolute; "),e.appendChild(l)}},{key:"init",value:function(){var t=this;this.connectingMagic(this.goThroughDots());var e=this;!0===this.responsive&&window.addEventListener("resize",function(){t.resize(e)})}},{key:"resize",value:function(t){document.getElementsByClassName("draad-line--"+t.element)[0].remove(),this.connectingMagic(t.goThroughDots())}},{key:"destroyDraad",value:function(){document.getElementsByClassName("draad-line--"+this.element)[0]&&(document.getElementsByClassName("draad-line--"+this.element)[0].remove(),window.removeEventListener("resize",this.resize),this.options={})}},{key:"destroy",get:function(){return this.destroyDraad()}}]),n}();exports.default=Draad;